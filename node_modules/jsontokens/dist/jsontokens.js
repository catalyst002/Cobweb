/*! For license information please see jsontokens.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jsontokens=e():t.jsontokens=e()}(this,(()=>{return t={192:(t,e)=>{"use strict";function r(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("Wrong positive integer: ".concat(t))}function n(t){if("boolean"!=typeof t)throw new Error("Expected boolean, not ".concat(t))}function o(t){if(!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(t.length))throw new TypeError("Expected Uint8Array of length ".concat(r,", not of length=").concat(t.length))}function i(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");r(t.outputLen),r(t.blockLen)}function a(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function u(t,e){o(t);var r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least ".concat(r))}Object.defineProperty(e,"__esModule",{value:!0}),e.output=e.exists=e.hash=e.bytes=e.bool=e.number=void 0,e.number=r,e.bool=n,e.bytes=o,e.hash=i,e.exists=a,e.output=u;var s={number:r,bool:n,bytes:o,hash:i,exists:a,output:u};e.default=s},434:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function u(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},s(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.SHA2=void 0;var c=r(192),f=r(312),h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(y,t);var e,r,n,h,l=(n=y,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=s(n);if(h){var r=s(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return u(this,t)});function y(t,e,r,n){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(o=l.call(this)).blockLen=t,o.outputLen=e,o.padOffset=r,o.isLE=n,o.finished=!1,o.length=0,o.pos=0,o.destroyed=!1,o.buffer=new Uint8Array(t),o.view=(0,f.createView)(o.buffer),o}return e=y,(r=[{key:"update",value:function(t){c.default.exists(this);for(var e=this.view,r=this.buffer,n=this.blockLen,o=(t=(0,f.toBytes)(t)).length,i=0;i<o;){var a=Math.min(n-this.pos,o-i);if(a!==n)r.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===n&&(this.process(e,0),this.pos=0);else for(var u=(0,f.createView)(t);n<=o-i;i+=n)this.process(u,i)}return this.length+=t.length,this.roundClean(),this}},{key:"digestInto",value:function(t){c.default.exists(this),c.default.output(t,this),this.finished=!0;var e=this.buffer,r=this.view,n=this.blockLen,o=this.isLE,i=this.pos;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>n-i&&(this.process(r,0),i=0);for(var a=i;a<n;a++)e[a]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);var o=BigInt(32),i=BigInt(4294967295),a=Number(r>>o&i),u=Number(r&i),s=n?4:0,c=n?0:4;t.setUint32(e+s,a,n),t.setUint32(e+c,u,n)}(r,n-8,BigInt(8*this.length),o),this.process(r,0);var u=(0,f.createView)(t);this.get().forEach((function(t,e){return u.setUint32(4*e,t,o)}))}},{key:"digest",value:function(){var t=this.buffer,e=this.outputLen;this.digestInto(t);var r=t.slice(0,e);return this.destroy(),r}},{key:"_cloneInto",value:function(t){var e,r;t||(t=new this.constructor),(e=t).set.apply(e,function(t){if(Array.isArray(t))return o(t)}(r=this.get())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var n=this.blockLen,i=this.buffer,a=this.length,u=this.finished,s=this.destroyed,c=this.pos;return t.length=a,t.pos=c,t.finished=u,t.destroyed=s,a%n&&t.buffer.set(i),t}}])&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(f.Hash);e.SHA2=h},400:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.crypto=void 0,e.crypto={node:void 0,web:"object"===("undefined"==typeof self?"undefined":r(self))&&"crypto"in self?self.crypto:void 0}},379:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.hmac=void 0;var s=r(192),c=r(312),f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(l,t);var e,r,n,f,h=(n=l,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(f){var r=u(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function l(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),(r=h.call(this)).finished=!1,r.destroyed=!1,s.default.hash(t);var n=(0,c.toBytes)(e);if(r.iHash=t.create(),!(r.iHash instanceof c.Hash))throw new TypeError("Expected instance of class which extends utils.Hash");var o=r.blockLen=r.iHash.blockLen;r.outputLen=r.iHash.outputLen;var i=new Uint8Array(o);i.set(n.length>r.iHash.blockLen?t.create().update(n).digest():n);for(var a=0;a<i.length;a++)i[a]^=54;r.iHash.update(i),r.oHash=t.create();for(var u=0;u<i.length;u++)i[u]^=106;return r.oHash.update(i),i.fill(0),r}return e=l,(r=[{key:"update",value:function(t){return s.default.exists(this),this.iHash.update(t),this}},{key:"digestInto",value:function(t){s.default.exists(this),s.default.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}},{key:"digest",value:function(){var t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}},{key:"_cloneInto",value:function(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));var e=this.oHash,r=this.iHash,n=this.finished,o=this.destroyed,i=this.blockLen,a=this.outputLen;return t.finished=n,t.destroyed=o,t.blockLen=i,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}])&&o(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(c.Hash);e.hmac=function(t,e,r){return new f(t,e).update(r).digest()},e.hmac.create=function(t,e){return new f(t,e)}},442:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.sha256=void 0;var s=r(434),c=r(312),f=function(t,e,r){return t&e^t&r^e&r},h=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),y=new Uint32Array(64),p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(d,t);var e,r,n,s,p=(n=d,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=u(n);if(s){var r=u(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return a(this,t)});function d(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(t=p.call(this,64,32,8,!1)).A=0|l[0],t.B=0|l[1],t.C=0|l[2],t.D=0|l[3],t.E=0|l[4],t.F=0|l[5],t.G=0|l[6],t.H=0|l[7],t}return e=d,(r=[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(t,e,r,n,o,i,a,u){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|o,this.F=0|i,this.G=0|a,this.H=0|u}},{key:"process",value:function(t,e){for(var r=0;r<16;r++,e+=4)y[r]=t.getUint32(e,!1);for(var n=16;n<64;n++){var o=y[n-15],i=y[n-2],a=(0,c.rotr)(o,7)^(0,c.rotr)(o,18)^o>>>3,u=(0,c.rotr)(i,17)^(0,c.rotr)(i,19)^i>>>10;y[n]=u+y[n-7]+a+y[n-16]|0}var s,l=this.A,p=this.B,d=this.C,v=this.D,g=this.E,w=this.F,b=this.G,m=this.H;for(r=0;r<64;r++){var x=m+((0,c.rotr)(g,6)^(0,c.rotr)(g,11)^(0,c.rotr)(g,25))+((s=g)&w^~s&b)+h[r]+y[r]|0,E=((0,c.rotr)(l,2)^(0,c.rotr)(l,13)^(0,c.rotr)(l,22))+f(l,p,d)|0;m=b,b=w,w=g,g=v+x|0,v=d,d=p,p=l,l=x+E|0}l=l+this.A|0,p=p+this.B|0,d=d+this.C|0,v=v+this.D|0,g=g+this.E|0,w=w+this.F|0,b=b+this.G|0,m=m+this.H|0,this.set(l,p,d,v,g,w,b,m)}},{key:"roundClean",value:function(){y.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}])&&o(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),d}(s.SHA2);e.sha256=(0,c.wrapConstructor)((function(){return new p}))},312:(t,e,r)=>{"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(){o=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),a=new A(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=E(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=h(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var l={};function y(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(O([])));w&&w!==e&&r.call(w,i)&&(v=w);var b=d.prototype=y.prototype=Object.create(v);function m(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==u(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=h(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=d,c(b,"constructor",d),c(d,"constructor",p),p.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(x.prototype),c(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(b),c(b,s,"Generator"),c(b,i,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=O,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function i(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,s,"next",t)}function s(t){i(a,n,o,u,s,"throw",t)}u(void 0)}))}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;var s=r(400);if(e.u8=function(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},e.u32=function(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))},e.createView=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},e.rotr=function(t,e){return t<<32-e|t>>>e},e.isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0],!e.isLE)throw new Error("Non little-endian hardware is not supported");var c=Array.from({length:256},(function(t,e){return e.toString(16).padStart(2,"0")}));e.bytesToHex=function(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");for(var e="",r=0;r<t.length;r++)e+=c[t[r]];return e},e.hexToBytes=function(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+u(t));if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");for(var e=new Uint8Array(t.length/2),r=0;r<e.length;r++){var n=2*r,o=t.slice(n,n+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[r]=i}return e};var f=function(){var t=a(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();function h(){return(h=a(o().mark((function t(r,n,i){var a,u,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Date.now(),u=0;case 2:if(!(u<r)){t.next=13;break}if(i(u),!((s=Date.now()-a)>=0&&s<n)){t.next=7;break}return t.abrupt("continue",10);case 7:return t.next=9,(0,e.nextTick)();case 9:a+=s;case 10:u++,t.next=2;break;case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t){if("string"!=typeof t)throw new TypeError("utf8ToBytes expected string, got ".concat(u(t)));return(new TextEncoder).encode(t)}function y(t){if("string"==typeof t&&(t=l(t)),!(t instanceof Uint8Array))throw new TypeError("Expected input type is Uint8Array (got ".concat(u(t),")"));return t}e.nextTick=f,e.asyncLoop=function(t,e,r){return h.apply(this,arguments)},e.utf8ToBytes=l,e.toBytes=y,e.concatBytes=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(!e.every((function(t){return t instanceof Uint8Array})))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];for(var n=e.reduce((function(t,e){return t+e.length}),0),o=new Uint8Array(n),i=0,a=0;i<e.length;i++){var u=e[i];o.set(u,a),a+=u.length}return o};var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,(r=[{key:"clone",value:function(){return this._cloneInto()}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.Hash=p,e.checkOpts=function(t,e){if(void 0!==e&&("object"!==u(e)||(r=e,"[object Object]"!==Object.prototype.toString.call(r)||r.constructor!==Object)))throw new TypeError("Options should be object or undefined");var r;return Object.assign(t,e)},e.wrapConstructor=function(t){var e=function(e){return t().update(y(e)).digest()},r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=function(){return t()},e},e.wrapConstructorWithOpts=function(t){var e=function(e,r){return t(r).update(y(e)).digest()},r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=function(e){return t(e)},e},e.randomBytes=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(s.crypto.web)return s.crypto.web.getRandomValues(new Uint8Array(t));if(s.crypto.node)return new Uint8Array(s.crypto.node.randomBytes(t).buffer);throw new Error("The environment doesn't have randomBytes function")}},475:(t,e,r)=>{"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(){a=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",u=n.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),a=new A(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=E(a,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=h(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(t,r,a),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var l={};function y(){}function p(){}function d(){}var v={};s(v,o,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(O([])));w&&w!==e&&r.call(w,o)&&(v=w);var b=d.prototype=y.prototype=Object.create(v);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){function n(o,i,a,u){var s=h(t[o],t,i);if("throw"!==s.type){var f=s.arg,l=f.value;return l&&"object"==c(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function E(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,E(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=h(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=d,s(b,"constructor",d),s(d,"constructor",p),p.displayName=s(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,u,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},m(x.prototype),s(x.prototype,i,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new x(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(b),s(b,u,"Generator"),s(b,o,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=O,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:O(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}function u(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function s(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){u(i,n,o,a,s,"next",t)}function s(t){u(i,n,o,a,s,"throw",t)}a(void 0)}))}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}Object.defineProperty(e,"__esModule",{value:!0}),e.utils=e.schnorr=e.verify=e.signSync=e.sign=e.getSharedSecret=e.recoverPublicKey=e.getPublicKey=e.Signature=e.Point=e.CURVE=void 0;var y=r(159),p=BigInt(0),d=BigInt(1),v=BigInt(2),g=BigInt(3),w=BigInt(8),b=Math.pow(v,BigInt(256)),m={a:p,b:BigInt(7),P:b-Math.pow(v,BigInt(32))-BigInt(977),n:b-BigInt("432420386565659656852420866394968145599"),h:d,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function x(t){var e=m.a,r=m.b,n=K(t*t),o=K(n*t);return K(o+e*t+r)}e.CURVE=m;var E=m.a===p,S=function(){function t(e,r,n){f(this,t),this.x=e,this.y=r,this.z=n}return l(t,[{key:"equals",value:function(e){if(!(e instanceof t))throw new TypeError("JacobianPoint expected");var r=this.x,n=this.y,o=this.z,i=e.x,a=e.y,u=e.z,s=K(Math.pow(o,v)),c=K(Math.pow(u,v)),f=K(r*c),h=K(i*s),l=K(K(n*u)*c),y=K(K(a*o)*s);return f===h&&l===y}},{key:"negate",value:function(){return new t(this.x,K(-this.y),this.z)}},{key:"double",value:function(){var e=this.x,r=this.y,n=this.z,o=K(Math.pow(e,v)),i=K(Math.pow(r,v)),a=K(Math.pow(i,v)),u=K(v*(K(Math.pow(e+i,v))-o-a)),s=K(g*o),c=K(Math.pow(s,v)),f=K(c-v*u);return new t(f,K(s*(u-f)-w*a),K(v*r*n))}},{key:"add",value:function(e){if(!(e instanceof t))throw new TypeError("JacobianPoint expected");var r=this.x,n=this.y,o=this.z,i=e.x,a=e.y,u=e.z;if(i===p||a===p)return this;if(r===p||n===p)return e;var s=K(Math.pow(o,v)),c=K(Math.pow(u,v)),f=K(r*c),h=K(i*s),l=K(K(n*u)*c),y=K(K(a*o)*s),d=K(h-f),g=K(y-l);if(d===p)return g===p?this.double():t.ZERO;var w=K(Math.pow(d,v)),b=K(d*w),m=K(f*w),x=K(Math.pow(g,v)-b-v*m);return new t(x,K(g*(m-x)-l*b),K(o*u*d))}},{key:"subtract",value:function(t){return this.add(t.negate())}},{key:"multiplyUnsafe",value:function(e){var r=t.ZERO;if("bigint"==typeof e&&e===p)return r;var n=D(e);if(n===d)return this;if(!E){for(var o=r,i=this;n>p;)n&d&&(o=o.add(i)),i=i.double(),n>>=d;return o}for(var a=W(n),u=a.k1neg,s=a.k1,c=a.k2neg,f=a.k2,h=r,l=r,y=this;s>p||f>p;)s&d&&(h=h.add(y)),f&d&&(l=l.add(y)),y=y.double(),s>>=d,f>>=d;return u&&(h=h.negate()),c&&(l=l.negate()),l=new t(K(l.x*m.beta),l.y,l.z),h.add(l)}},{key:"precomputeWindow",value:function(t){for(var e=E?128/t+1:256/t+1,r=[],n=this,o=n,i=0;i<e;i++){o=n,r.push(o);for(var a=1;a<Math.pow(2,t-1);a++)o=o.add(n),r.push(o);n=o.double()}return r}},{key:"wNAF",value:function(e,r){!r&&this.equals(t.BASE)&&(r=A.BASE);var n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");var o=r&&k.get(r);o||(o=this.precomputeWindow(n),r&&1!==n&&(o=t.normalizeZ(o),k.set(r,o)));for(var i=t.ZERO,a=t.ZERO,u=1+(E?128/n:256/n),s=Math.pow(2,n-1),c=BigInt(Math.pow(2,n)-1),f=Math.pow(2,n),h=BigInt(n),l=0;l<u;l++){var y=l*s,p=Number(e&c);if(e>>=h,p>s&&(p-=f,e+=d),0===p){var v=o[y];l%2&&(v=v.negate()),a=a.add(v)}else{var g=o[y+Math.abs(p)-1];p<0&&(g=g.negate()),i=i.add(g)}}return{p:i,f:a}}},{key:"multiply",value:function(e,r){var n,o,i=D(e);if(E){var a=W(i),u=a.k1neg,s=a.k1,c=a.k2neg,f=a.k2,h=this.wNAF(s,r),l=h.p,y=h.f,p=this.wNAF(f,r),d=p.p,v=p.f;u&&(l=l.negate()),c&&(d=d.negate()),d=new t(K(d.x*m.beta),d.y,d.z),n=l.add(d),o=y.add(v)}else{var g=this.wNAF(i,r);n=g.p,o=g.f}return t.normalizeZ([n,o])[0]}},{key:"toAffine",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V(this.z),e=this.x,r=this.y,n=this.z,o=t,i=K(o*o),a=K(i*o),u=K(e*i),s=K(r*a),c=K(n*o);if(c!==d)throw new Error("invZ was invalid");return new A(u,s)}}],[{key:"fromAffine",value:function(e){if(!(e instanceof A))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new t(e.x,e.y,d)}},{key:"toAffineBatch",value:function(t){var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.P,r=new Array(t.length),n=V(t.reduce((function(t,n,o){return n===p?t:(r[o]=t,K(t*n,e))}),d),e);return t.reduceRight((function(t,n,o){return n===p?t:(r[o]=K(t*r[o],e),K(t*n,e))}),n),r}(t.map((function(t){return t.z})));return t.map((function(t,r){return t.toAffine(e[r])}))}},{key:"normalizeZ",value:function(e){return t.toAffineBatch(e).map(t.fromAffine)}}]),t}();S.BASE=new S(m.Gx,m.Gy,d),S.ZERO=new S(p,d,p);var k=new WeakMap,A=function(){function t(e,r){f(this,t),this.x=e,this.y=r}return l(t,[{key:"_setWindowSize",value:function(t){this._WINDOW_SIZE=t,k.delete(this)}},{key:"toRawBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return R(this.toHex(t))}},{key:"toHex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=L(this.x);if(t){var r=this.y&d?"03":"02";return"".concat(r).concat(e)}return"04".concat(e).concat(L(this.y))}},{key:"toHexX",value:function(){return this.toHex(!0).slice(2)}},{key:"toRawX",value:function(){return this.toRawBytes(!0).slice(1)}},{key:"assertValidity",value:function(){var t="Point is not on elliptic curve",e=this.x,r=this.y;if(!Z(e)||!Z(r))throw new Error(t);var n=K(r*r);if(K(n-x(e))!==p)throw new Error(t)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"negate",value:function(){return new t(this.x,K(-this.y))}},{key:"double",value:function(){return S.fromAffine(this).double().toAffine()}},{key:"add",value:function(t){return S.fromAffine(this).add(S.fromAffine(t)).toAffine()}},{key:"subtract",value:function(t){return this.add(t.negate())}},{key:"multiply",value:function(t){return S.fromAffine(this).multiply(t,this).toAffine()}},{key:"multiplyAndAddUnsafe",value:function(e,r,n){var o=S.fromAffine(this),i=r===p||r===d||this!==t.BASE?o.multiplyUnsafe(r):o.multiply(r),a=S.fromAffine(e).multiplyUnsafe(n),u=i.add(a);return u.equals(S.ZERO)?void 0:u.toAffine()}}],[{key:"fromCompressedHex",value:function(e){var r=32===e.length,n=N(r?e:e.subarray(1));if(!Z(n))throw new Error("Point is not on curve");var o=function(t){var e=m.P,r=BigInt(6),n=BigInt(11),o=BigInt(22),i=BigInt(23),a=BigInt(44),u=BigInt(88),s=t*t*t%e,c=s*s*t%e,f=G(c,g)*c%e,h=G(f,g)*c%e,l=G(h,v)*s%e,y=G(l,n)*l%e,p=G(y,o)*y%e,d=G(p,a)*p%e,w=G(d,u)*d%e,b=G(w,a)*p%e,x=G(b,g)*c%e,E=G(x,i)*y%e,S=G(E,r)*s%e;return G(S,v)}(x(n)),i=(o&d)===d;r?i&&(o=K(-o)):1==(1&e[0])!==i&&(o=K(-o));var a=new t(n,o);return a.assertValidity(),a}},{key:"fromUncompressedHex",value:function(e){var r=new t(N(e.subarray(1,33)),N(e.subarray(33,65)));return r.assertValidity(),r}},{key:"fromHex",value:function(t){var e=M(t),r=e.length,n=e[0];if(32===r||33===r&&(2===n||3===n))return this.fromCompressedHex(e);if(65===r&&4===n)return this.fromUncompressedHex(e);throw new Error("Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ".concat(r))}},{key:"fromPrivateKey",value:function(e){return t.BASE.multiply(Y(e))}},{key:"fromSignature",value:function(e,r,n){var o=J(e=M(e)),i=tt(r),a=i.r,u=i.s;if(0!==n&&1!==n)throw new Error("Cannot recover signature: invalid recovery bit");var s=1&n?"03":"02",c=t.fromHex(s+L(a)),f=m.n,h=V(a,f),l=K(-o*h,f),y=K(u*h,f),p=t.BASE.multiplyAndAddUnsafe(c,l,y);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}}]),t}();function O(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function P(t){if(t.length<2||2!==t[0])throw new Error("Invalid signature integer tag: ".concat(T(t)));var e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:N(r),left:t.subarray(e+2)}}e.Point=A,A.BASE=new A(m.Gx,m.Gy),A.ZERO=new A(p,p);var j=function(){function t(e,r){f(this,t),this.r=e,this.s=r,this.assertValidity()}return l(t,[{key:"assertValidity",value:function(){var t=this.r,e=this.s;if(!q(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!q(e))throw new Error("Invalid Signature: s must be 0 < s < n")}},{key:"hasHighS",value:function(){var t=m.n>>d;return this.s>t}},{key:"normalizeS",value:function(){return this.hasHighS()?new t(this.r,m.n-this.s):this}},{key:"toDERRawBytes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return R(this.toDERHex(t))}},{key:"toDERHex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=O(C(this.s));if(t)return e;var r=O(C(this.r)),n=C(r.length/2),o=C(e.length/2),i=C(r.length/2+e.length/2+4);return"30".concat(i,"02").concat(n).concat(r,"02").concat(o).concat(e)}},{key:"toRawBytes",value:function(){return this.toDERRawBytes()}},{key:"toHex",value:function(){return this.toDERHex()}},{key:"toCompactRawBytes",value:function(){return R(this.toCompactHex())}},{key:"toCompactHex",value:function(){return L(this.r)+L(this.s)}}],[{key:"fromCompact",value:function(e){var r=_(e),n="Signature.fromCompact";if("string"!=typeof e&&!r)throw new TypeError("".concat(n,": Expected string or Uint8Array"));var o=r?T(e):e;if(128!==o.length)throw new Error("".concat(n,": Expected 64-byte hex"));return new t(U(o.slice(0,64)),U(o.slice(64,128)))}},{key:"fromDER",value:function(e){var r=_(e);if("string"!=typeof e&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");var n=function(t){if(t.length<2||48!=t[0])throw new Error("Invalid signature tag: ".concat(T(t)));if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");var e=P(t.subarray(2)),r=e.data,n=P(e.left),o=n.data,i=n.left;if(i.length)throw new Error("Invalid signature: left bytes after parsing: ".concat(T(i)));return{r,s:o}}(r?e:R(e));return new t(n.r,n.s)}},{key:"fromHex",value:function(t){return this.fromDER(t)}}]),t}();function B(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(!e.every(_))throw new Error("Uint8Array list expected");if(1===e.length)return e[0];for(var n=e.reduce((function(t,e){return t+e.length}),0),o=new Uint8Array(n),i=0,a=0;i<e.length;i++){var u=e[i];o.set(u,a),a+=u.length}return o}function _(t){return t instanceof Uint8Array}e.Signature=j;var H=Array.from({length:256},(function(t,e){return e.toString(16).padStart(2,"0")}));function T(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var e="",r=0;r<t.length;r++)e+=H[t[r]];return e}function L(t){if(t>b)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function I(t){return R(L(t))}function C(t){var e=t.toString(16);return 1&e.length?"0".concat(e):e}function U(t){if("string"!=typeof t)throw new TypeError("hexToNumber: expected string, got "+c(t));return BigInt("0x".concat(t))}function R(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+c(t));if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);for(var e=new Uint8Array(t.length/2),r=0;r<e.length;r++){var n=2*r,o=t.slice(n,n+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[r]=i}return e}function N(t){return U(T(t))}function M(t){return t instanceof Uint8Array?Uint8Array.from(t):R(t)}function D(t){if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if("bigint"==typeof t&&q(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function K(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.P,r=t%e;return r>=p?r:e+r}function G(t,e){for(var r=m.P,n=t;e-- >p;)n*=n,n%=r;return n}function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.P;if(t===p||e<=p)throw new Error("invert: expected positive integers, got n=".concat(t," mod=").concat(e));for(var r=K(t,e),n=e,o=p,i=d,a=d,u=p;r!==p;){var s=n/r,c=n%r,f=o-a*s,h=i-u*s;n=r,r=c,o=a,i=u,a=f,u=h}var l=n;if(l!==d)throw new Error("invert: does not exist");return K(o,e)}var F=function(t,e){return(t+e/v)/e},z=Math.pow(v,BigInt(128));function W(t){var e=m.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-d*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,a=F(i*t,e),u=F(-n*t,e),s=K(t-a*r-u*o,e),c=K(-a*n-u*i,e),f=s>z,h=c>z;if(f&&(s=e-s),h&&(c=e-c),s>z||c>z)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:f,k1:s,k2neg:h,k2:c}}function J(t){var e=m.n,r=8*t.length-256,n=N(t);return r>0&&(n>>=BigInt(r)),n>=e&&(n-=e),n}var $=function(){function t(){f(this,t),this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}var r,n;return l(t,[{key:"hmac",value:function(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.utils).hmacSha256.apply(t,[this.k].concat(n))}},{key:"hmacSync",value:function(){var t;if("function"!=typeof e.utils.hmacSha256Sync)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var i=(t=e.utils).hmacSha256Sync.apply(t,[this.k].concat(n));if(i instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return i}},{key:"incr",value:function(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}},{key:"reseed",value:(n=s(a().mark((function t(){var e,r=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:new Uint8Array,t.next=3,this.hmac(this.v,Uint8Array.from([0]),e);case 3:return this.k=t.sent,t.next=6,this.hmac(this.v);case 6:if(this.v=t.sent,0!==e.length){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,this.hmac(this.v,Uint8Array.from([1]),e);case 11:return this.k=t.sent,t.next=14,this.hmac(this.v);case 14:this.v=t.sent;case 15:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"reseedSync",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),0!==t.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}},{key:"generate",value:(r=s(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.incr(),t.next=3,this.hmac(this.v);case 3:return this.v=t.sent,t.abrupt("return",this.v);case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"generateSync",value:function(){return this.incr(),this.v=this.hmacSync(this.v),this.v}}]),t}();function q(t){return p<t&&t<m.n}function Z(t){return p<t&&t<m.P}function X(t,e,r){var n=N(t);if(q(n)){var o=m.n,i=A.BASE.multiply(n),a=K(i.x,o);if(a!==p){var u=K(V(n,o)*K(e+r*a,o),o);if(u!==p){var s=new j(a,u);return{sig:s,recovery:(i.x===s.r?0:2)|Number(i.y&d)}}}}}function Y(t){var e;if("bigint"==typeof t)e=t;else if("number"==typeof t&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if("string"==typeof t){if(64!==t.length)throw new Error("Expected 32 bytes of private key");e=U(t)}else{if(!_(t))throw new TypeError("Expected valid private key");if(32!==t.length)throw new Error("Expected 32 bytes of private key");e=N(t)}if(!q(e))throw new Error("Expected private key: 0 < key < n");return e}function Q(t){return t instanceof A?(t.assertValidity(),t):A.fromHex(t)}function tt(t){if(t instanceof j)return t.assertValidity(),t;try{return j.fromDER(t)}catch(e){return j.fromCompact(t)}}function et(t){var e=_(t),r="string"==typeof t,n=(e||r)&&t.length;return e?33===n||65===n:r?66===n||130===n:t instanceof A}function rt(t){return N(t.length>32?t.slice(0,32):t)}function nt(t){if("bigint"!=typeof t)throw new Error("Expected bigint");return R(L(t))}function ot(t,r,n){if(null==t)throw new Error('sign: expected valid message hash, not "'.concat(t,'"'));var o,i,a,u=M(t),s=Y(r),c=[nt(s),(o=u,i=rt(o),a=K(i,m.n),nt(a<p?i:a))];if(null!=n){!0===n&&(n=e.utils.randomBytes(32));var f=M(n);if(32!==f.length)throw new Error("sign: Expected 32 bytes of extra data");c.push(f)}return{seed:B.apply(void 0,c),m:rt(u),d:s}}function it(t,e){var r=t.sig,n=t.recovery,o=Object.assign({canonical:!0,der:!0},e),i=o.canonical,a=o.der,u=o.recovered;i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);var s=a?r.toDERRawBytes():r.toCompactRawBytes();return u?[s,n]:s}function at(){return at=s(a().mark((function t(e,r){var n,o,i,u,s,c,f,h=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=h.length>2&&void 0!==h[2]?h[2]:{},o=ot(e,r,n.extraEntropy),i=o.seed,u=o.m,s=o.d,f=new $,t.next=5,f.reseed(i);case 5:return t.t0=X,t.next=8,f.generate();case 8:if(t.t1=t.sent,t.t2=u,t.t3=s,c=(0,t.t0)(t.t1,t.t2,t.t3)){t.next=16;break}return t.next=14,f.reseed();case 14:t.next=5;break;case 16:return t.abrupt("return",it(c,n));case 17:case"end":return t.stop()}}),t)}))),at.apply(this,arguments)}e.getPublicKey=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return A.fromPrivateKey(t).toRawBytes(e)},e.recoverPublicKey=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return A.fromSignature(t,e,r).toRawBytes(n)},e.getSharedSecret=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(et(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!et(e))throw new TypeError("getSharedSecret: second arg must be public key");var n=Q(e);return n.assertValidity(),n.multiply(Y(t)).toRawBytes(r)},e.sign=function(t,e){return at.apply(this,arguments)},e.signSync=function(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=ot(t,e,n.extraEntropy),i=o.seed,a=o.m,u=o.d,s=new $;for(s.reseedSync(i);!(r=X(s.generateSync(),a,u));)s.reseedSync();return it(r,n)};var ut={strict:!0};function st(t){return K(N(t),m.n)}function ct(t){return(t.y&d)===p}e.verify=function(t,e,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ut;try{n=tt(t),e=M(e)}catch(t){return!1}var i=n,a=i.r,u=i.s;if(o.strict&&n.hasHighS())return!1;var s,c=J(e);try{s=Q(r)}catch(t){return!1}var f=m.n,h=V(u,f),l=K(c*h,f),y=K(a*h,f),p=A.BASE.multiplyAndAddUnsafe(s,l,y);if(!p)return!1;var d=K(p.x,f);return d===a};var ft=function(){function t(e,r){f(this,t),this.r=e,this.s=r,this.assertValidity()}return l(t,[{key:"assertValidity",value:function(){var t=this.r,e=this.s;if(!Z(t)||!q(e))throw new Error("Invalid signature")}},{key:"toHex",value:function(){return L(this.r)+L(this.s)}},{key:"toRawBytes",value:function(){return R(this.toHex())}}],[{key:"fromHex",value:function(e){var r=M(e);if(64!==r.length)throw new TypeError("SchnorrSignature.fromHex: expected 64 bytes, not ".concat(r.length));return new t(N(r.subarray(0,32)),N(r.subarray(32,64)))}}]),t}();function ht(t,e,r){if(null==t)throw new TypeError('sign: Expected valid message, not "'.concat(t,'"'));var n=M(t),o=Y(e),i=M(r);if(32!==i.length)throw new TypeError("sign: Expected 32 bytes of aux randomness");var a=A.fromPrivateKey(o),u=a.toRawX();return{m:n,P:a,px:u,d:ct(a)?o:m.n-o,rand:i}}function lt(t,e){return I(t^N(e))}function yt(t){var e=K(N(t),m.n);if(e===p)throw new Error("sign: Creation of signature failed. k is zero");var r=A.fromPrivateKey(e),n=r.toRawX();return{R:r,rx:n,k:ct(r)?e:m.n-e}}function pt(t,e,r,n){return new ft(t.x,K(e+r*n,m.n)).toRawBytes()}function dt(){return dt=s(a().mark((function t(r,n){var o,i,u,s,c,f,h,l,y,p,d,v,g,w=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=w.length>2&&void 0!==w[2]?w[2]:e.utils.randomBytes(),i=ht(r,n,o),u=i.m,s=i.px,c=i.d,f=i.rand,t.t0=lt,t.t1=c,t.next=6,e.utils.taggedHash(At.aux,f);case 6:return t.t2=t.sent,h=(0,t.t0)(t.t1,t.t2),t.t3=yt,t.next=11,e.utils.taggedHash(At.nonce,h,s,u);case 11:return t.t4=t.sent,l=(0,t.t3)(t.t4),y=l.R,p=l.rx,d=l.k,t.t5=st,t.next=19,e.utils.taggedHash(At.challenge,p,s,u);case 19:return t.t6=t.sent,v=(0,t.t5)(t.t6),g=pt(y,d,v,c),t.next=24,wt(g,u,s);case 24:if(t.sent){t.next=27;break}throw new Error("sign: Invalid signature produced");case 27:return t.abrupt("return",g);case 28:case"end":return t.stop()}}),t)}))),dt.apply(this,arguments)}function vt(t,e,r){var n=t instanceof ft,i=n?t:ft.fromHex(t);return n&&i.assertValidity(),o(o({},i),{},{m:M(e),P:Q(r)})}function gt(t,e,r,n){var o=A.BASE.multiplyAndAddUnsafe(e,Y(r),K(-n,m.n));return!(!o||!ct(o)||o.x!==t)}function wt(t,e,r){return bt.apply(this,arguments)}function bt(){return(bt=s(a().mark((function t(r,n,o){var i,u,s,c,f,h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i=vt(r,n,o),u=i.r,s=i.s,c=i.m,f=i.P,t.t0=st,t.next=5,e.utils.taggedHash(At.challenge,I(u),f.toRawX(),c);case 5:return t.t1=t.sent,h=(0,t.t0)(t.t1),t.abrupt("return",gt(u,f,s,h));case 10:return t.prev=10,t.t2=t.catch(0),t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function mt(t,r,n){try{var o=vt(t,r,n),i=o.r,a=o.s,u=o.m,s=o.P,c=st(e.utils.taggedHashSync(At.challenge,I(i),s.toRawX(),u));return gt(i,s,a,c)}catch(t){return!1}}e.schnorr={Signature:ft,getPublicKey:function(t){return A.fromPrivateKey(t).toRawX()},sign:function(t,e){return dt.apply(this,arguments)},verify:wt,signSync:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.utils.randomBytes(),o=ht(t,r,n),i=o.m,a=o.px,u=o.d,s=o.rand,c=lt(u,e.utils.taggedHashSync(At.aux,s)),f=yt(e.utils.taggedHashSync(At.nonce,c,a,i)),h=f.R,l=f.rx,y=f.k,p=st(e.utils.taggedHashSync(At.challenge,l,a,i)),d=pt(h,y,p,u),v=mt(d,i,a);if(!v)throw new Error("sign: Invalid signature produced");return d},verifySync:mt},A.BASE._setWindowSize(8);var xt,Et,St,kt={node:y,web:"object"===("undefined"==typeof self?"undefined":c(self))&&"crypto"in self?self.crypto:void 0},At={challenge:"BIP0340/challenge",aux:"BIP0340/aux",nonce:"BIP0340/nonce"},Ot={};e.utils={isValidPrivateKey:function(t){try{return Y(t),!0}catch(t){return!1}},privateAdd:function(t,e){return I(K(Y(t)+Y(e),m.n))},privateNegate:function(t){var e=Y(t);return I(m.n-e)},pointAddScalar:function(t,e,r){var n=A.fromHex(t),o=Y(e),i=A.BASE.multiplyAndAddUnsafe(n,o,d);if(!i)throw new Error("Tweaked point at infinity");return i.toRawBytes(r)},pointMultiply:function(t,e,r){var n=A.fromHex(t),o=N(M(e));return n.multiply(o).toRawBytes(r)},hashToPrivateKey:function(t){if((t=M(t)).length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return I(K(N(t),m.n-d)+d)},randomBytes:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(kt.web)return kt.web.getRandomValues(new Uint8Array(t));if(kt.node){var e=kt.node.randomBytes;return Uint8Array.from(e(t))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:function(){return e.utils.hashToPrivateKey(e.utils.randomBytes(40))},bytesToHex:T,hexToBytes:R,concatBytes:B,mod:K,invert:V,sha256:(St=s(a().mark((function t(){var e,r,n,o,i,u,s=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=s.length,r=new Array(e),n=0;n<e;n++)r[n]=s[n];if(!kt.web){t.next=8;break}return t.next=4,kt.web.subtle.digest("SHA-256",B.apply(void 0,r));case 4:return o=t.sent,t.abrupt("return",new Uint8Array(o));case 8:if(!kt.node){t.next=15;break}return i=kt.node.createHash,u=i("sha256"),r.forEach((function(t){return u.update(t)})),t.abrupt("return",Uint8Array.from(u.digest()));case 15:throw new Error("The environment doesn't have sha256 function");case 16:case"end":return t.stop()}}),t)}))),function(){return St.apply(this,arguments)}),hmacSha256:(Et=s(a().mark((function t(e){var r,n,o,i,u,s,c,f,h=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=h.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=h[o];if(!kt.web){t.next=12;break}return t.next=4,kt.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 4:return i=t.sent,u=B.apply(void 0,n),t.next=8,kt.web.subtle.sign("HMAC",i,u);case 8:return s=t.sent,t.abrupt("return",new Uint8Array(s));case 12:if(!kt.node){t.next=19;break}return c=kt.node.createHmac,f=c("sha256",e),n.forEach((function(t){return f.update(t)})),t.abrupt("return",Uint8Array.from(f.digest()));case 19:throw new Error("The environment doesn't have hmac-sha256 function");case 20:case"end":return t.stop()}}),t)}))),function(t){return Et.apply(this,arguments)}),sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:(xt=s(a().mark((function t(r){var n,o,i,u,s,c,f=arguments;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(o=Ot[r])){t.next=7;break}return t.next=4,e.utils.sha256(Uint8Array.from(r,(function(t){return t.charCodeAt(0)})));case 4:i=t.sent,o=B(i,i),Ot[r]=o;case 7:for(u=f.length,s=new Array(u>1?u-1:0),c=1;c<u;c++)s[c-1]=f[c];return t.abrupt("return",(n=e.utils).sha256.apply(n,[o].concat(s)));case 9:case"end":return t.stop()}}),t)}))),function(t){return xt.apply(this,arguments)}),taggedHashSync:function(t){var r;if("function"!=typeof e.utils.sha256Sync)throw new Error("utils.sha256Sync is undefined, you need to set it");var n=Ot[t];if(void 0===n){var o=e.utils.sha256Sync(Uint8Array.from(t,(function(t){return t.charCodeAt(0)})));n=B(o,o),Ot[t]=n}for(var i=arguments.length,a=new Array(i>1?i-1:0),u=1;u<i;u++)a[u-1]=arguments[u];return(r=e.utils).sha256Sync.apply(r,[n].concat(a))},precompute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A.BASE,r=e===A.BASE?e:new A(e.x,e.y);return r._setWindowSize(t),r.multiply(g),r}}},979:(t,e)=>{"use strict";e.byteLength=function(t){var e=s(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=s(t),a=i[0],u=i[1],c=new o(function(t,e,r){return 3*(e+r)/4-r}(0,a,u)),f=0,h=u>0?a-4:a;for(r=0;r<h;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],c[f++]=e>>16&255,c[f++]=e>>8&255,c[f++]=255&e;return 2===u&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,c[f++]=255&e),1===u&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,c[f++]=e>>8&255,c[f++]=255&e),c},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=16383,u=0,s=n-o;u<s;u+=a)i.push(c(t,u,u+a>s?s:u+a));return 1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};for(var r=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=i.length;a<u;++a)r[a]=i[a],n[i.charCodeAt(a)]=a;function s(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,n){for(var o,i,a=[],u=e;u<n;u+=3)o=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},481:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=e.unescape=e.escape=e.pad=void 0;const n=r(979);function o(t){return`${t}${"=".repeat(4-(t.length%4||4))}`}function i(t){return t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(t){return o(t).replace(/-/g,"+").replace(/_/g,"/")}e.pad=o,e.escape=i,e.unescape=a,e.encode=function(t){return i((0,n.fromByteArray)((new TextEncoder).encode(t)))},e.decode=function(t){return(new TextDecoder).decode((0,n.toByteArray)(o(a(t))))}},454:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cryptoClients=e.SECP256K1Client=void 0;const n=r(641);Object.defineProperty(e,"SECP256K1Client",{enumerable:!0,get:function(){return n.SECP256K1Client}});const o={ES256K:n.SECP256K1Client};e.cryptoClients=o},641:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SECP256K1Client=void 0;const n=r(379),o=r(442),i=r(475),a=r(272),u=r(758),s=r(312);i.utils.hmacSha256Sync=(t,...e)=>{const r=n.hmac.create(o.sha256,t);return e.forEach((t=>r.update(t))),r.digest()};class c{static derivePublicKey(t,e=!0){return 66===t.length&&(t=t.slice(0,64)),t.length<64&&(t=t.padStart(64,"0")),(0,s.bytesToHex)(i.getPublicKey(t,e))}static signHash(t,e,r="jose"){if(!t||!e)throw new u.MissingParametersError("a signing input hash and private key are all required");const n=i.signSync(t,e.slice(0,64),{der:!0,canonical:!1});if("der"===r)return(0,s.bytesToHex)(n);if("jose"===r)return(0,a.derToJose)(n,"ES256");throw Error("Invalid signature format")}static loadSignature(t){return(0,a.joseToDer)(t,"ES256")}static verifyHash(t,e,r){if(!t||!e||!r)throw new u.MissingParametersError("a signing input hash, der signature, and public key are all required");return i.verify(e,t,r,{strict:!1})}}e.SECP256K1Client=c,c.algorithmName="ES256K"},923:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.hashSha256Async=e.hashSha256=void 0;const o=r(442);function i(t){return(0,o.sha256)(t)}e.hashSha256=i,e.hashSha256Async=function(t){return n(this,void 0,void 0,(function*(){try{if("undefined"!=typeof crypto&&void 0!==crypto.subtle){const e="string"==typeof t?(new TextEncoder).encode(t):t,r=yield crypto.subtle.digest("SHA-256",e);return new Uint8Array(r)}{const e=r(573);if(!e.createHash)throw new Error("`crypto` module does not contain `createHash`");return Promise.resolve(e.createHash("sha256").update(t).digest())}}catch(e){return console.log(e),console.log('Crypto lib not found. Neither the global `crypto.subtle` Web Crypto API, nor the or the Node.js `require("crypto").createHash` module is available. Falling back to JS implementation.'),Promise.resolve(i(t))}}))}},647:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decodeToken=void 0;const n=r(481);e.decodeToken=function(t){if("string"==typeof t){const e=t.split(".");return{header:JSON.parse(n.decode(e[0])),payload:JSON.parse(n.decode(e[1])),signature:e[2]}}if("object"==typeof t){if("string"!=typeof t.payload)throw new Error("Expected token payload to be a base64 or json string");let e=t.payload;"{"!==t.payload[0]&&(e=n.decode(e));const r=[];return t.header.map((t=>{const e=JSON.parse(n.decode(t));r.push(e)})),{header:r,payload:JSON.parse(e),signature:t.signature}}}},272:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.joseToDer=e.derToJose=void 0;const n=r(979),o=r(481);function i(t){return(t/8|0)+(t%8==0?0:1)}const a={ES256:i(256),ES384:i(384),ES512:i(521)};function u(t){const e=a[t];if(e)return e;throw new Error(`Unknown algorithm "${t}"`)}function s(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return(0,n.toByteArray)((0,o.pad)(t));throw new TypeError("ECDSA signature must be a Base64 string or a Uint8Array")}function c(t,e,r){let n=0;for(;e+n<r&&0===t[e+n];)++n;return t[e+n]>=128&&--n,n}e.derToJose=function(t,e){const r=s(t),i=u(e),a=i+1,c=r.length;let f=0;if(48!==r[f++])throw new Error('Could not find expected "seq"');let h=r[f++];if(129===h&&(h=r[f++]),c-f<h)throw new Error(`"seq" specified length of "${h}", only "${c-f}" remaining`);if(2!==r[f++])throw new Error('Could not find expected "int" for "r"');const l=r[f++];if(c-f-2<l)throw new Error(`"r" specified length of "${l}", only "${c-f-2}" available`);if(a<l)throw new Error(`"r" specified length of "${l}", max of "${a}" is acceptable`);const y=f;if(f+=l,2!==r[f++])throw new Error('Could not find expected "int" for "s"');const p=r[f++];if(c-f!==p)throw new Error(`"s" specified length of "${p}", expected "${c-f}"`);if(a<p)throw new Error(`"s" specified length of "${p}", max of "${a}" is acceptable`);const d=f;if(f+=p,f!==c)throw new Error(`Expected to consume entire array, but "${c-f}" bytes remain`);const v=i-l,g=i-p,w=new Uint8Array(v+l+g+p);for(f=0;f<v;++f)w[f]=0;w.set(r.subarray(y+Math.max(-v,0),y+l),f),f=i;for(const t=f;f<t+g;++f)w[f]=0;return w.set(r.subarray(d+Math.max(-g,0),d+p),f),(0,o.escape)((0,n.fromByteArray)(w))},e.joseToDer=function(t,e){t=s(t);const r=u(e),n=t.length;if(n!==2*r)throw new TypeError(`"${e}" signatures must be "${2*r}" bytes, saw "${n}"`);const o=c(t,0,r),i=c(t,r,t.length),a=r-o,f=r-i,h=2+a+1+1+f,l=h<128,y=new Uint8Array((l?2:3)+h);let p=0;return y[p++]=48,l?y[p++]=h:(y[p++]=129,y[p++]=255&h),y[p++]=2,y[p++]=a,o<0?(y[p++]=0,y.set(t.subarray(0,r),p),p+=r):(y.set(t.subarray(o,r),p),p+=r-o),y[p++]=2,y[p++]=f,i<0?(y[p++]=0,y.set(t.subarray(r),p)):y.set(t.subarray(r+i),p),y}},758:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InvalidTokenError=e.MissingParametersError=void 0;class r extends Error{constructor(t){super(),this.name="MissingParametersError",this.message=t||""}}e.MissingParametersError=r;class n extends Error{constructor(t){super(),this.name="InvalidTokenError",this.message=t||""}}e.InvalidTokenError=n},607:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(942),e),o(r(555),e),o(r(647),e),o(r(758),e),o(r(454),e)},942:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TokenSigner=e.createUnsecuredToken=void 0;const o=r(481),i=r(454),a=r(758),u=r(923);function s(t,e){const r=[],n=o.encode(JSON.stringify(e));r.push(n);const i=o.encode(JSON.stringify(t));return r.push(i),r.join(".")}e.createUnsecuredToken=function(t){return s(t,{typ:"JWT",alg:"none"})+"."},e.TokenSigner=class{constructor(t,e){if(!t||!e)throw new a.MissingParametersError("a signing algorithm and private key are required");if("string"!=typeof t)throw new Error("signing algorithm parameter must be a string");if(t=t.toUpperCase(),!i.cryptoClients.hasOwnProperty(t))throw new Error("invalid signing algorithm");this.tokenType="JWT",this.cryptoClient=i.cryptoClients[t],this.rawPrivateKey=e}header(t={}){const e={typ:this.tokenType,alg:this.cryptoClient.algorithmName};return Object.assign({},e,t)}sign(t,e=!1,r={}){const n=this.header(r),o=s(t,n),i=(0,u.hashSha256)(o);return this.createWithSignedHash(t,e,n,o,i)}signAsync(t,e=!1,r={}){return n(this,void 0,void 0,(function*(){const n=this.header(r),o=s(t,n),i=yield(0,u.hashSha256Async)(o);return this.createWithSignedHash(t,e,n,o,i)}))}createWithSignedHash(t,e,r,n,i){const a=this.cryptoClient.signHash(i,this.rawPrivateKey);return e?{header:[o.encode(JSON.stringify(r))],payload:JSON.stringify(t),signature:[a]}:[n,a].join(".")}}},555:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TokenVerifier=void 0;const n=r(481),o=r(454),i=r(758),a=r(923);e.TokenVerifier=class{constructor(t,e){if(!t||!e)throw new i.MissingParametersError("a signing algorithm and public key are required");if("string"!=typeof t)throw"signing algorithm parameter must be a string";if(t=t.toUpperCase(),!o.cryptoClients.hasOwnProperty(t))throw"invalid signing algorithm";this.tokenType="JWT",this.cryptoClient=o.cryptoClients[t],this.rawPublicKey=e}verify(t){return"string"==typeof t?this.verifyCompact(t,!1):"object"==typeof t&&this.verifyExpanded(t,!1)}verifyAsync(t){return"string"==typeof t?this.verifyCompact(t,!0):"object"==typeof t?this.verifyExpanded(t,!0):Promise.resolve(!1)}verifyCompact(t,e){const r=t.split("."),n=r[0]+"."+r[1],o=t=>{const e=this.cryptoClient.loadSignature(r[2]);return this.cryptoClient.verifyHash(t,e,this.rawPublicKey)};if(e)return(0,a.hashSha256Async)(n).then((t=>o(t)));{const t=(0,a.hashSha256)(n);return o(t)}}verifyExpanded(t,e){const r=[t.header.join("."),n.encode(t.payload)].join(".");let o=!0;const i=e=>(t.signature.map((t=>{const r=this.cryptoClient.loadSignature(t);this.cryptoClient.verifyHash(e,r,this.rawPublicKey)||(o=!1)})),o);if(e)return(0,a.hashSha256Async)(r).then((t=>i(t)));{const t=(0,a.hashSha256)(r);return i(t)}}}},159:()=>{},573:()=>{}},e={},function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}(607);var t,e}));